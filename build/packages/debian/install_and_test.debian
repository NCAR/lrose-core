#! /bin/bash

os_version=$1
lrose_package=$2

#
# in clean docker image,
# install rpm and test that the apps work
#

cd ~/git/lrose-core/build/packages/debian

# remove any old image

docker image rm ${os_version}:install

# make .deb file available to container

debDir=/tmp/${os_version}-${lrose_package}/debs

# copy install script into that dir so it is available to the container

cp install_pkg_inside_container.debian $debDir

# install the rpms in a container

docker build \
    -v ${debDir}:/debs \
    --tag ${os_version}:install \
    --file Dockerfile.${os_version}.install_and_test .

